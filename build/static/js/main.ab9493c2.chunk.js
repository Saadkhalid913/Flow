(this["webpackJsonpflow-frontend"]=this["webpackJsonpflow-frontend"]||[]).push([[0],{104:function(e,t,n){},105:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),a=n(29),o=n.n(a),i=n(26),s=n(5),u=n(54),j=Object(c.createContext)(),d=n(59),f=n(3),l=n(19),b=n(2),m=function(e){var t=Object(c.useState)(""),n=Object(s.a)(t,2),r=n[0],a=n[1],o=Object(c.useContext)(j),i=o.Socket,u=o.name,d=o.setName,f=o.setRoom,m=o.setIsAdmin;Object(c.useEffect)((function(){if(i){var t=function(t,n,c){f(t),m(c),d(n),c?e.history.push("/room/admin/"+t):e.history.push("/room/"+t)};return i.on("room-joined",t),function(){return i.off("room-joined",t)}}}),[i,m,d,e,f]);return Object(b.jsx)("div",{className:"room-join-screen-wrapper",children:Object(b.jsxs)("div",{className:"room-join-box",children:[Object(b.jsx)("div",{children:Object(b.jsx)("input",{placeholder:"Name",onChange:function(e){return d(e.target.value)}})}),Object(b.jsxs)("div",{children:[Object(b.jsx)("input",{placeholder:"room code",onChange:function(e){a(e.target.value)}}),Object(b.jsx)("button",{onClick:function(){u&&r?i.emit("join-room",r,u):r?u||l.a.warn("Please enter a name"):l.a.warn("Please enter the room code")},children:"Join Room"})]}),Object(b.jsx)("button",{onClick:function(){u?i.emit("create-room",u):l.a.warn("Please enter a name")},children:"Create Room"})]})})},h=function(e){var t=e.onPenChange,n=e.onColorChange;return Object(b.jsxs)("div",{className:"canvas-control",children:[Object(b.jsxs)("div",{children:[Object(b.jsx)("label",{htmlFor:"pen-size",children:"Pen Size"}),Object(b.jsx)("input",{name:"pen-size",onChange:function(e){return t(e.target.value)},defaultValue:"10",type:"range",min:"1",max:"100"})]}),Object(b.jsxs)("div",{children:[Object(b.jsx)("label",{htmlFor:"pen-color",children:"Pen Color"}),Object(b.jsx)("input",{name:"pen-color",onChange:function(e){return n(e.target.value)},type:"color"})]}),Object(b.jsx)("button",{onClick:function(){return e.onClear()},children:"Clear"})]})},O=function(e){var t=Object(c.useContext)(j),n=t.Socket,a=t.room,o=t.isAdmin,i=Object(c.useRef)(),s=Object(c.useRef)(!1),u=Object(c.useRef)("#000000"),d=Object(c.useRef)(10),f=function(){n.emit("canvas-cleared",a),i.current.getContext("2d").clearRect(0,0,i.current.width,i.current.height)},l=function(e,t,n,c){var r=i.current.getContext("2d");r.beginPath(),r.strokeStyle=u.current,r.lineWidth=d.current,r.lineCap="round",r.moveTo(e,t),r.lineTo(n,c),r.stroke(),r.closePath()};return Object(c.useEffect)((function(){!o&&n&&n.on("canvas-cleared",(function(){return f()}))})),Object(c.useEffect)((function(){if(i.current&&o){var e=0,t=0;i.current.addEventListener("mousedown",(function(n){e=n.offsetX,t=n.offsetY,s.current=!0})),i.current.addEventListener("mouseup",(function(n){e=n.offsetX,t=n.offsetY,s.current=!1})),i.current.addEventListener("mousemove",(function(c){s.current&&(l(e,t,c.offsetX,c.offsetY),n.emit("canvas-edited",e,t,c.offsetX,c.offsetY,a),e=c.offsetX,t=c.offsetY,n.emit("canvas-image-edited",i.current.toDataURL("image/png"),a))})),i.current.addEventListener("touchstart",(function(n){n.preventDefault();var c=n.target.getBoundingClientRect();e=n.targetTouches[0].clientX-c.x,t=n.targetTouches[0].clientY-c.y,s.current=!0})),i.current.addEventListener("touchend",(function(e){e.preventDefault(),s.current=!1})),i.current.addEventListener("touchmove",(function(c){if(c.preventDefault(),s.current){var r=c.target.getBoundingClientRect(),o=c.targetTouches[0].clientX-r.x,u=c.targetTouches[0].clientY-r.y;l(e,t,o,u),n.emit("canvas-edited",e,t,c.offsetX,c.offsetY,a),e=o,t=u,n.emit("canvas-image-edited",i.current.toDataURL("image/png"),a)}}))}})),Object(c.useEffect)((function(){if(n){var e=function(e){!function(e){var t=i.current.getContext("2d"),n=new Image;n.src=e,n.onload=function(){t.drawImage(n,0,0,i.current.width,i.current.height)}}(e)};return n.on("canvas-image-update",e),function(){return n.off("canvas-image-update",e)}}}),[n,e]),Object(b.jsxs)(r.a.Fragment,{children:[Object(b.jsx)("canvas",{ref:i,width:e.width,height:9*e.width/16}),o&&Object(b.jsx)(h,{onClear:f,onPenChange:function(e){return d.current=e},onColorChange:function(e){return u.current=e}})]})},x=n(14),v=function(e){var t=e.chat,n=t.message,c=t.name,r=t.isOwn;return Object(b.jsxs)("div",{className:r?"own-chat-message":"chat-message",children:[Object(b.jsx)("h5",{children:r?"You":c}),Object(b.jsx)("p",{children:n})]})},g=n(56),p=n(55),w=function(e){var t=Object(c.useState)([]),n=Object(s.a)(t,2),a=n[0],o=n[1],i=Object(c.useContext)(j),u=i.room,d=i.Socket,f=i.name,l=Object(c.useState)(""),m=Object(s.a)(l,2),h=m[0],O=m[1],w=Object(c.useState)(!1),C=Object(s.a)(w,2),k=C[0],S=C[1];Object(c.useEffect)((function(){if(d){var e=function(e){var t={name:e.name,message:e.message,isOwn:e.isOwn};o([].concat(Object(x.a)(a),[t]))};return d.on("chat-recieved",e),function(){return d.off("chat-recieved",e)}}}),[o,d,a]);var y={};return window.innerWidth>768&&k&&(y={right:"0%"}),window.innerWidth>768&&!k&&(y={right:"-30%"}),window.innerWidth<768&&!k&&(y={top:"100%",right:"0%"}),window.innerWidth<768&&k&&(y={top:"10%",right:"0%"}),Object(b.jsxs)(r.a.Fragment,{children:[Object(b.jsx)("button",{className:"chat-toggle-button",onClick:function(){return S(!0)},children:Object(b.jsx)(p.a,{})}),Object(b.jsxs)("div",{className:"chatbox",style:y,children:[Object(b.jsx)("button",{className:"chatbox-toggle",onClick:function(){return S(!1)},children:Object(b.jsx)(g.a,{})}),Object(b.jsx)("div",{className:"chatbox-chats",children:a.map((function(e){return Object(b.jsx)(v,{chat:e},e.name+e.message+Math.random())}))}),Object(b.jsxs)("div",{className:"chat-message-box",children:[Object(b.jsx)("input",{placeholder:"Write a message",value:h,onChange:function(e){return O(e.target.value)}}),Object(b.jsx)("button",{onClick:function(){if(h){d.emit("new-chat",h,f,u);var e={name:f,message:h,isOwn:!0};o([].concat(Object(x.a)(a),[e])),O("")}},children:"Send"})]})]})]})},C=n(35),k=n.n(C),S=n(57),y=n(58),R=function(e){var t=Object(c.useContext)(j),n=t.room,r=t.Socket,a=t.isAdmin,o=Object(c.useState)([]),i=Object(s.a)(o,2),u=i[0],d=i[1];return Object(c.useEffect)((function(){r&&r.on("files-uploaded",(function(e,t,n){d([].concat(Object(x.a)(u),[{link:URL.createObjectURL(new Blob([e],{type:n,name:t})),name:t}]))}))})),Object(b.jsxs)("div",{className:"file-box",children:[a&&Object(b.jsx)("input",{type:"file",onChange:function(){var e=Object(y.a)(k.a.mark((function e(t){var c,a,o,i;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=Object(S.a)(t.target.files),e.prev=1,c.s();case 3:if((a=c.n()).done){e.next=12;break}return o=a.value,e.next=7,o.arrayBuffer();case 7:i=e.sent,r.emit("file-upload",i,o.name,o.type,n),d([].concat(Object(x.a)(u),[{link:URL.createObjectURL(new Blob([o],{type:o.type,name:o.name})),name:o.name}]));case 10:e.next=3;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),c.e(e.t0);case 17:return e.prev=17,c.f(),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[1,14,17,20]])})));return function(t){return e.apply(this,arguments)}}()}),Object(b.jsx)("div",{className:"filebox-files",children:u.map((function(e){return Object(b.jsxs)("div",{className:"file-box-file",children:[Object(b.jsx)("span",{onClick:function(){return window.open(e.link)},children:e.name}),a&&Object(b.jsx)("button",{onClick:function(){var t=u.indexOf(e),n=Object(x.a)(u);n.splice(t,1),d(n)},children:"adaw"})]},e.name)}))})]})},N=function(e){Object(c.useContext)(j).room||e.history.replace("/");var t=Object(c.useState)(window.innerWidth),n=Object(s.a)(t,2),r=n[0],a=n[1];return window.addEventListener("resize",(function(){a(window.innerWidth)})),Object(b.jsxs)("div",{className:"room-page-wrapper",children:[Object(b.jsx)(O,{id:"canvas-element",width:.8*r}),Object(b.jsx)(R,{}),Object(b.jsx)(w,{})]})};n(96);l.a.configure();var E=function(){var e=Object(c.useState)(),t=Object(s.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(),o=Object(s.a)(a,2),l=o[0],h=o[1],O=Object(c.useState)(),x=Object(s.a)(O,2),v=x[0],g=x[1],p=Object(c.useState)(),w=Object(s.a)(p,2),C=w[0],k=w[1];return Object(c.useEffect)((function(){var e=Object(u.io)("/");return r(e),function(){return e.disconnect()}}),[r]),Object(b.jsx)(j.Provider,{value:{Socket:n,room:l,setRoom:h,name:C,setName:k,isAdmin:v,setIsAdmin:g},children:Object(b.jsx)(d.a,{children:Object(b.jsxs)(f.c,{children:[Object(b.jsx)(f.a,{path:"/room/admin/:id",render:function(e){return Object(b.jsx)(N,Object(i.a)(Object(i.a)({},e),{},{admin:!0}))}}),Object(b.jsx)(f.a,{path:"/room/:id",render:function(e){return Object(b.jsx)(N,Object(i.a)({},e))}}),Object(b.jsx)(f.a,{path:"/",render:function(e){return Object(b.jsx)(m,Object(i.a)({},e))}})]})})})};n(104);o.a.render(Object(b.jsx)(r.a.StrictMode,{children:Object(b.jsx)(E,{})}),document.getElementById("root"))}},[[105,1,2]]]);
//# sourceMappingURL=main.ab9493c2.chunk.js.map